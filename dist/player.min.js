!function a(s,r,n){function l(e,t){if(!r[e]){if(!s[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(o)return o(e,!0);throw(i=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",i}i=r[e]={exports:{}},s[e][0].call(i.exports,function(t){return l(s[e][1][t]||t)},i,i.exports,a,s,r,n)}return r[e].exports}for(var o="function"==typeof require&&require,t=0;t<n.length;t++)l(n[t]);return l}({1:[function(t,e,i){"use strict";function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],a=!0,s=!1,r=void 0;try{for(var n,l=t[Symbol.iterator]();!(a=(n=l.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function r(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function l(t){var e=~~(t/3600),i=~~(t%3600/60),a=~~t%60,t="";return 0<e&&(t+=e+":"+(i<10?"0":"")),(t+=i+":"+(a<10?"0":""))+""+a}Object.defineProperty(i,"__esModule",{value:!0}),i.PlaylistPlayer=void 0;var s=function(){function s(t,e,i,a){!function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(e.player=this).playerElm=e,this.playerElm.classList.add("playlist-player"),this.src=JSON.parse(t.innerText),this.album=this.src.album||"ALBUM TITLE",this.artist=this.src.artist||"ARTIST NAME",this.artwork=this.src.artwork||null,this.list=this.src.tracks,this.separator=i||": ",this.strings=a||{play:"&#9654;",pause:"&#x23F8;&#xFE0E;",stop:"&#11035;",next:"&#x23ED;&#xFE0E;",prev:"&#x23EE;&#xFE0E;",mute:"&#128263;"},this.build()}var t,e,i;return t=s,(e=[{key:"mute",value:function(){this.log("mute"),0<this.audioPlayer.volume?(this.audioPlayer.savedVolume=this.audioPlayer.volume,this.audioPlayer.volume=0):this.audioPlayer.volume=this.audioPlayer.savedVolume||1}},{key:"build",value:function(){this.buildDisplay(),this.updateTrackDisplay()}},{key:"buildDisplay",value:function(){var i=this;this.display=this.createElement({type:"div",parentElm:this.playerElm,cls:"player-display",attrs:null}),this.display.artwork=this.createElement({type:"img",cls:null,attrs:{src:this.artwork}}),this.display.parentElement.insertBefore(this.display.artwork,this.display),this.listElm=this.createElement({type:"ol",parentElm:this.display,cls:null}),this.audioPlayer=this.createElement({type:"audio",parentElm:this.playerElm,cls:null}),this.currentArtist=this.createElement({type:"div",parentElm:this.display,cls:null}),this.audioPlayer=document.createElement("audio"),this.audioPlayer.addEventListener("timeupdate",this.updateTimeDisplay.bind(this)),this.audioPlayer.addEventListener("ended",this.next.bind(this)),this.audioPlayer.addEventListener("canplay",this.renderStamps.bind(this));var e=this;["song","artist","album","progress","progressContainer"].forEach(function(t){e.display[t]=document.createElement("div"),e.display[t].setAttribute("data-label",t),e.display.appendChild(e.display[t])}),this.buildControls(),this.list.forEach(function(t,e){t=i.layoutTrack(t,e);Promise.resolve(t).then(function(t){i.listElm.insertBefore(t,i.listElm.childNodes[e])})})}},{key:"buildControls",value:function(){var e=this;this.display.progressContainer=this.createElement({type:"div",parentElm:this.display,cls:"progress-container"}),this.display.currentTime=this.createElement({type:"div",parentElm:this.display.progressContainer,cls:"time"}),this.display.progress=this.createElement({type:"div",parentElm:this.display.progressContainer,cls:"progress"});var i=this.createElement({type:"div",parentElm:this.display,cls:"controls"}),a=this;["play","pause","stop","prev","next","mute"].forEach(function(t){a["".concat(t,"Btn")]=e.createElement({type:"button",innerHTML:e.strings[t],parentElm:i,attrs:{"data-action":t}}),a["".concat(t,"Btn")].addEventListener("click",a[t].bind(a))}),this.pauseBtn.classList.add("hide"),this.display.progressContainer.addEventListener("click",this.seek.bind(this)),this.listElm.addEventListener("click",function(t){a.playIndex(t.target.getAttribute("data-index"))})}},{key:"playIndex",value:function(t){t=parseInt(t),this.setIndex(t),this.setTrack(),this.play()}},{key:"setIndex",value:function(t){this.index=t;t=this.listElm.querySelector('button[data-index="'.concat(t,'"]'));this.clearActiveButtons(),t&&t.classList.add("active")}},{key:"clearActiveButtons",value:function(){this.listElm.querySelectorAll("button.active").forEach(function(t){t.classList.remove("active")})}},{key:"setTrack",value:function(){this.audioPlayer.src=this.list[this.index].file,this.updateTimeDisplay(),this.updateTrackDisplay()}},{key:"play",value:function(){this.log("play"),this.index||this.setIndex(0),this.audioPlayer.src||this.setTrack(),this.audioPlayer.play(),this.playBtn.classList.add("hide"),this.pauseBtn.classList.remove("hide")}},{key:"pause",value:function(){this.log("pause"),this.audioPlayer.pause(),this.pauseBtn.classList.add("hide"),this.playBtn.classList.remove("hide")}},{key:"stop",value:function(){this.log("stop"),this.pause(),this.audioPlayer.currentTime=0}},{key:"prev",value:function(){this.log("prev"),this.setIndex(this.normalizeIndex(this.index-1)),this.setTrack(),this.play()}},{key:"next",value:function(){this.log("next"),this.setIndex(this.normalizeIndex(this.index+1)),this.setTrack(),this.play()}},{key:"seek",value:function(t){var e=t.target,i=(e=e.classList.contains("stamp")?e.parentElement:e).getClientRects()[0],e=(t.clientX-i.left)/e.offsetWidth*this.audioPlayer.duration;this.audioPlayer.currentTime=e}},{key:"normalizeIndex",value:function(t){return t<this.list.length&&0<=t?t:0}},{key:"layoutTrack",value:function(t,e){var i=document.createElement("li");return i.innerHTML='<button data-index="'.concat(e,'"> <span class="title">').concat(t.title,'</span>\n     <div class="artist-album__wrapper">\n      <span class="artist">').concat(t.artist||this.artist,"</span>").concat(this.separator,'<span class="album">').concat(t.album||this.album,"</span>\n     </div>\n     </button>"),i}},{key:"updateAlbumDisplay",value:function(){var t=this.index||0;this.display.artist.innerText=this.list[t].artist||this.artist,this.display.album.innerText=this.list[t].album||this.album}},{key:"updateTrackDisplay",value:function(){var t=this.index||0,e=this.display;e.song.innerText=this.list[t].title,e.artist.innerText=this.list[t].artist||this.artist,e.album.innerText=this.list[t].album||this.album,e.artwork.src=this.list[t].artwork||this.artwork}},{key:"updateTimeDisplay",value:function(){var t=this.display;t.currentTime.innerText="".concat(l(this.audioPlayer.currentTime)," / ").concat(l(this.audioPlayer.duration)),t.progress.style.width=this.audioPlayer.currentTime/this.audioPlayer.duration*100+"%",this.audioPlayer.hasStamps&&this.checkStampsForDisplay()}},{key:"checkStampsForDisplay",value:function(){var i,t=this.list[this.index];t.stamps&&(i=this.audioPlayer.currentTime,t.stamps.forEach(function(t){var e=5;t.duration&&(e=t.duration),i>=t.time&&i<=t.time+e?t.elm.classList.add("visible"):t.elm.classList.remove("visible")}))}},{key:"renderStamps",value:function(){var e=this;this.eraseStamps();var t=this.list[this.index];t.stamps&&(this.audioPlayer.hasStamps=!0,t.stamps.forEach(function(t){t.elm=e.createElement({type:"span",cls:"stamp",parentElm:e.display.progressContainer,attrs:{"data-label":t.message}}),t.elm.style.left=t.time/e.audioPlayer.duration*100+"%",t.duration&&(t.elm.style.width=t.duration/e.audioPlayer.duration*100+"%")}))}},{key:"eraseStamps",value:function(){this.audioPlayer.hasStamps=!1,this.display.progressContainer.querySelectorAll(".stamp").forEach(function(t){t.remove()})}},{key:"createElement",value:function(t){var e=document.createElement(t.type);if(t.cls&&e.classList.add(t.cls),t.attrs)for(var i=0,a=Object.entries(t.attrs);i<a.length;i++){var s=n(a[i],2),r=s[0],s=s[1];e.setAttribute(r,s)}return t.innerHTML&&(e.innerHTML=t.innerHTML),t.parentElm&&t.parentElm.appendChild(e),e}},{key:"destroy",value:function(){}},{key:"log",value:function(t){}}])&&r(t.prototype,e),i&&r(t,i),s}();i.PlaylistPlayer=s,window.PlaylistPlayer=s},{}]},{},[1]);
